/*!
 * ExpressionEngine - by EllisLab
 *
 * @package		ExpressionEngine
 * @author		EllisLab Dev Team
<<<<<<< HEAD
 * @copyright	Copyright (c) 2003 - 2014, EllisLab, Inc.
=======
 * @copyright	Copyright (c) 2003 - 2013, EllisLab, Inc.
>>>>>>> 0fa8825dc34df02ef80cbe3b3e72c69db1cc2cc1
 * @license		http://ellislab.com/expressionengine/user-guide/license.html
 * @link		http://ellislab.com
 * @since		Version 2.3
 * @filesource
 */
<<<<<<< HEAD
!function(t){"use strict";function e(t){this.size=0,this.limit=t,this.cache=[],this.cache_map=[]}function i(e,i){var s=this;this.els=t("p."+e.uniqid),this.template_id=e.uniqid+"_pag_template",t.template(this.template_id,e.pagination),this.els.delegate("a","click",function(){var t=s._extract_qs(this.href,i.options.base_url);return i.add_filter(t),!1})}function s(e,i){var s=this;if(this.sort=[],this.plugin=i,this.headers=i.element.find("th"),this.css={asc:e.cssAsc,desc:e.cssDesc},this.header_map={},this._initial_sort=e.sort,!e.pagination)return void t(i.element).tablesorter();this.headers.each(function(){var i=t(this),r=i.data("table_column");s.header_map[r]=i,i.data("sortable",e.columns[r].sort)}),i.element.find("thead").delegate("th","selectstart",function(){return!1}).delegate("th","click",function(i){var r=t(this);if(r.has("input").length)return!0;if(!r.data("sortable"))return!1;var n=i.shiftKey?"add":"set";return s[n](r.data("table_column"),r.hasClass(e.cssAsc)?"desc":"asc"),!1});for(var r=this._initial_sort.length;r--;){var n=this.header_map[this._initial_sort[r][0]];void 0!==n&&(this.sort.push(this._initial_sort[r]),n.toggleClass(this.css.asc,"asc"===this._initial_sort[r][1]).toggleClass(this.css.desc,"desc"===this._initial_sort[r][1]))}}// ensure copyright notice on all files (I always forget ...)
t.widget("ee.table",{_listening:t(),_template_string:"",_current_data:{},options:{uniqid:null,base_url:null,pagination:null,template:null,pag_template:null,rows:[],sort:[],columns:[],cache_limit:600,filters:{},cssAsc:"headerSortDown",cssDesc:"headerSortUp"},_create:function(){var r=this,n=r.options;r.tbody=r.element.find("tbody"),r.tbody.size()||(r.tbody=t("<tbody/>"),r.element.append(r.tbody)),r.no_results=t("<div />").html(n.no_results),r.tbody.children().length||(r.element.hide(),r.element.after(r.no_results)),r.filters=n.filters,n.base_url=n.base_url.replace(new RegExp("&amp;","g"),"&"),r.sort=new s(n,r),r.cache=new e(n.cache_limit),r.pagination=new i(n,r);var a=r._prep_for_cache(),h={html_rows:r.tbody.find("tr"),pagination:r.pagination.html(),rows:n.rows};r.cache.set(a,h),r._current_data=h,r.template_id=n.uniqid+"_row_template",r.set_template(n.template),r._trigger("create",null,r._ui({data:h}))},get_container:function(){return this.tbody},set_container:function(e){this.tbody=t(e)},get_header:function(e){self.element.find("th").filter(function(){return t(this).data("table_column")==e})},get_template:function(){return this._template_string},set_template:function(e){this._template_string=e,t.template(this.template_id,e)},get_current_data:function(){return this._current_data},clear_cache:function(){return this.cache.clear(),this},clear_filters:function(){return this.filters={},this._listening.each(function(){t(this).unbind("interact.ee_table")}),this},clear_sort:function(){return this.sort.reset(),this},add_filter:function(e){var i=this,s=EE.BASE+"&"+i.options.base_url;if(t.isPlainObject(e))return i._set_filter(i._listening),i.filters=t.extend(i.filters,e),i._request(s),this;var r,n=e.closest("form"),a="interact.ee_table";return n&&e.is(n)?a+=" submit.ee_table":e.bind("keydown",function(t){13==t.keyCode&&t.preventDefault()}),t(e).bind(a,function(){return clearTimeout(r),r=setTimeout(function(){i._set_filter(i._listening),i._request(s)},200),!1}),i._listening=i._listening.add(e),i._set_filter(i._listening),this},set_sort:function(t,e){return this.sort.set(t,e),this},add_sort:function(t,e){return this.sort.add(t,e),this},refresh:function(){var t=EE.BASE+"&"+this.options.base_url;return this._request(t),this},_request:function(e){var i,s,r=this;r._trigger("load",null,r._ui()),s=function(t){r._current_data=t,t.rows.length?(r.element.show(),r.tbody.html(t.html_rows),r.no_results.remove(),EE.cp.zebra_tables(r.element)):r.tbody.is("tbody")?(r.tbody.empty(),r.element.hide(),r.element.after(r.no_results)):r.tbody.html(r.no_results),r.pagination.update(t.pagination),r._trigger("update",null,r._ui({data:t}))};var n=r._prep_for_cache();return i=r.cache.get(n),null!==i?s(i):(r.filters.tbl_offset&&(e+="&tbl_offset="+r.filters.tbl_offset,delete r.filters.tbl_offset),r.filters.XID=EE.XID,void t.ajax(e,{type:"post",data:r.filters,success:function(e){e.html_rows=t.tmpl(r.template_id,e.rows),e.pagination=r.pagination.parse(e.pagination),r.cache.set(n,e,e.rows.length),s(e)},dataType:"json"}))},_prep_for_cache:function(){this.filters.tbl_sort=this.sort.get();var t,e=/^(XID|S|D|C|M)$/,i=[];for(t in this.filters)""==this.filters[t]||null!==e.exec(t)?delete this.filters[t]:i.push(t,this.filters[t]);return i.sort(),i.join("")},_set_filter:function(e){var i=e.serializeArray(),s=this;t.each(i,function(){s.filters[this.name]=this.value})},_ui:function(e){return e=e||{},t.extend({sort:this.sort.get(),filters:this.filters},e)}}),e.prototype={limit:function(){return this.limit},size:function(){return this.cache.length},set:function(t,e,i){for(var s=i||1;this.size+s>this.limit;){var r=this.cache.shift();this.cache_map.shift(),this.size-=r[2]}return this.cache.push([t,e,s]),this.cache_map.push(t),this.size+=s,this},get:function(t){var e,i=this._find(t);return i>-1?(e=this.cache.splice(i,1)[0],this.cache.push(e),this.cache_map.splice(i,1),this.cache_map.push(e[0]),e[1]):null},"delete":function(t){var e,i=this._find(t);return i>-1&&(e=this.cache.splice(i,1),this.cache_map.splice(i,1),this.size-=e[2]),this},clear:function(){return this.size=0,this.cache=[],this.cache_map=[],this},_find:function(t){if(!Array.prototype.indexOf){for(var e=this.cache_map,i=e.length,s=0;i>s;s++)if(e[s]==t)return s;return-1}return this.cache_map.indexOf(t)}},i.prototype={parse:function(e){return e?t.tmpl(this.template_id,e).html():""},update:function(t){return t?void this.els.html(t).show():void this.els.html("")},html:function(){return this.els.html()},_qs_splitter:new RegExp("([^&=]+)=?([^&]*)","g"),_extract_qs:function(t,e){t=t.replace(e,"");var i,s=t.indexOf("?"),r={};for(s>0&&(t=t.slice(s+1));i=this._qs_splitter.exec(t);)r[decodeURIComponent(i[1])]=decodeURIComponent(i[2]);return r}},s.prototype={get:function(t){if(t){for(var e=this.sort.length;e--;)if(this.sort[e][0]==t)return this.sort[e][1];return null}return this.sort},add:function(t,e){var i,s=t;for(e&&(s=[[t,e]]),i=s.length;i--;)this.sort.push(s[i]),this.header_map[s[i][0]].toggleClass(this.css.asc,"asc"===s[i][1]).toggleClass(this.css.desc,"desc"===s[i][1]);return this.plugin.refresh(),this},set:function(t,e){return this.clear(),this.add(t,e),this},reset:function(){return this.clear(),this.set(this._initial_sort),this.plugin.refresh(),this},clear:function(){for(var t=this.sort.length;t--;)this.header_map[this.sort[t][0]].removeClass(this.css.asc+" "+this.css.desc);return this.sort=[],this}}}(jQuery);
=======

(function(e){function g(a){this.size=0;this.limit=a;this.cache=[];this.cache_map=[]}function h(a,b){var c=this;this.els=e("p."+a.uniqid);this.template_id=a.uniqid+"_pag_template";e.template(this.template_id,a.pagination);this.els.delegate("a","click",function(){var a=c._extract_qs(this.href,b.options.base_url);b.add_filter(a);return!1})}function i(a,b){var c=this;this.sort=[];this.plugin=b;this.headers=b.element.find("th");this.css={asc:a.cssAsc,desc:a.cssDesc};this.header_map={};this._initial_sort=
a.sort;if(a.pagination){this.headers.each(function(){var b=e(this),d=b.data("table_column");c.header_map[d]=b;b.data("sortable",a.columns[d].sort)});b.element.find("thead").delegate("th","selectstart",function(){return!1}).delegate("th","click",function(b){var d=e(this);if(d.has("input").length)return!0;if(!d.data("sortable"))return!1;c[b.shiftKey?"add":"set"](d.data("table_column"),d.hasClass(a.cssAsc)?"desc":"asc");return!1});for(var d=this._initial_sort.length;d--;){var f=this.header_map[this._initial_sort[d][0]];
void 0!==f&&(this.sort.push(this._initial_sort[d]),f.toggleClass(this.css.asc,"asc"===this._initial_sort[d][1]).toggleClass(this.css.desc,"desc"===this._initial_sort[d][1]))}}else e(b.element).tablesorter()}e.widget("ee.table",{_listening:e(),_template_string:"",_current_data:{},options:{uniqid:null,base_url:null,pagination:null,template:null,pag_template:null,rows:[],sort:[],columns:[],cache_limit:600,filters:{},cssAsc:"headerSortDown",cssDesc:"headerSortUp"},_create:function(){var a=this.options;
this.tbody=this.element.find("tbody");if(!this.tbody.size())this.tbody=e("<tbody/>"),this.element.append(this.tbody);this.no_results=e("<div />").html(a.no_results);this.tbody.children().length||(this.element.hide(),this.element.after(this.no_results));this.filters=a.filters;a.base_url=a.base_url.replace(RegExp("&amp;","g"),"&");this.sort=new i(a,this);this.cache=new g(a.cache_limit);this.pagination=new h(a,this);var b=this._prep_for_cache(),c={html_rows:this.tbody.find("tr"),pagination:this.pagination.html(),
rows:a.rows};this.cache.set(b,c);this._current_data=c;this.template_id=a.uniqid+"_row_template";this.set_template(a.template);this._trigger("create",null,this._ui({data:c}))},get_container:function(){return this.tbody},set_container:function(a){this.tbody=e(a)},get_header:function(a){self.element.find("th").filter(function(){return e(this).data("table_column")==a})},get_template:function(){return this._template_string},set_template:function(a){this._template_string=a;e.template(this.template_id,a)},
get_current_data:function(){return this._current_data},clear_cache:function(){this.cache.clear();return this},clear_filters:function(){this.filters={};this._listening.each(function(){e(this).unbind("interact.ee_table")});return this},clear_sort:function(){this.sort.reset();return this},add_filter:function(a){var b=this,c=EE.BASE+"&"+b.options.base_url;if(e.isPlainObject(a))return b._set_filter(b._listening),b.filters=e.extend(b.filters,a),b._request(c),this;var d=a.closest("form"),f="interact.ee_table",
j;d&&a.is(d)?f+=" submit.ee_table":a.bind("keydown",function(a){13==a.keyCode&&a.preventDefault()});e(a).bind(f,function(){clearTimeout(j);j=setTimeout(function(){b._set_filter(b._listening);b._request(c)},200);return!1});b._listening=b._listening.add(a);b._set_filter(b._listening);return this},set_sort:function(a,b){this.sort.set(a,b);return this},add_sort:function(a,b){this.sort.add(a,b);return this},refresh:function(){this._request(EE.BASE+"&"+this.options.base_url);return this},_request:function(a){var b=
this,c,d;b._trigger("load",null,b._ui());d=function(a){b._current_data=a;a.rows.length?(b.element.show(),b.tbody.html(a.html_rows),b.no_results.remove(),EE.cp.zebra_tables(b.element)):b.tbody.is("tbody")?(b.tbody.empty(),b.element.hide(),b.element.after(b.no_results)):b.tbody.html(b.no_results);b.pagination.update(a.pagination);b._trigger("update",null,b._ui({data:a}))};var f=b._prep_for_cache();c=b.cache.get(f);if(null!==c)return d(c);b.filters.tbl_offset&&(a+="&tbl_offset="+b.filters.tbl_offset,
delete b.filters.tbl_offset);b.filters.XID=EE.XID;e.ajax(a,{type:"post",data:b.filters,success:function(a){a.html_rows=e.tmpl(b.template_id,a.rows);a.pagination=b.pagination.parse(a.pagination);b.cache.set(f,a,a.rows.length);d(a)},dataType:"json"})},_prep_for_cache:function(){this.filters.tbl_sort=this.sort.get();var a,b=/^(XID|S|D|C|M)$/,c=[];for(a in this.filters)""==this.filters[a]||null!==b.exec(a)?delete this.filters[a]:c.push(a,this.filters[a]);c.sort();return c.join("")},_set_filter:function(a){var a=
a.serializeArray(),b=this;e.each(a,function(){b.filters[this.name]=this.value})},_ui:function(a){a=a||{};return e.extend({sort:this.sort.get(),filters:this.filters},a)}});g.prototype={limit:function(){return this.limit},size:function(){return this.cache.length},set:function(a,b,c){for(c=c||1;this.size+c>this.limit;){var d=this.cache.shift();this.cache_map.shift();this.size-=d[2]}this.cache.push([a,b,c]);this.cache_map.push(a);this.size+=c;return this},get:function(a){var b=this._find(a);return-1<
b?(a=this.cache.splice(b,1)[0],this.cache.push(a),this.cache_map.splice(b,1),this.cache_map.push(a[0]),a[1]):null},"delete":function(a){var b=this._find(a);-1<b&&(a=this.cache.splice(b,1),this.cache_map.splice(b,1),this.size-=a[2]);return this},clear:function(){this.size=0;this.cache=[];this.cache_map=[];return this},_find:function(a){if(!Array.prototype.indexOf){for(var b=this.cache_map,c=b.length,d=0;d<c;d++)if(b[d]==a)return d;return-1}return this.cache_map.indexOf(a)}};h.prototype={parse:function(a){return!a?
"":e.tmpl(this.template_id,a).html()},update:function(a){a?this.els.html(a).show():this.els.html("")},html:function(){return this.els.html()},_qs_splitter:RegExp("([^&=]+)=?([^&]*)","g"),_extract_qs:function(a,b){var a=a.replace(b,""),c;c=a.indexOf("?");var d={};for(0<c&&(a=a.slice(c+1));c=this._qs_splitter.exec(a);)d[decodeURIComponent(c[1])]=decodeURIComponent(c[2]);return d}};i.prototype={get:function(a){if(a){for(var b=this.sort.length;b--;)if(this.sort[b][0]==a)return this.sort[b][1];return null}return this.sort},
add:function(a,b){var c=a,d;b&&(c=[[a,b]]);for(d=c.length;d--;)this.sort.push(c[d]),this.header_map[c[d][0]].toggleClass(this.css.asc,"asc"===c[d][1]).toggleClass(this.css.desc,"desc"===c[d][1]);this.plugin.refresh();return this},set:function(a,b){this.clear();this.add(a,b);this.plugin.refresh();return this},reset:function(){this.clear();this.set(this._initial_sort);this.plugin.refresh();return this},clear:function(){for(var a=this.sort.length;a--;)this.header_map[this.sort[a][0]].removeClass(this.css.asc+
" "+this.css.desc);this.sort=[];return this}}})(jQuery);
>>>>>>> 0fa8825dc34df02ef80cbe3b3e72c69db1cc2cc1
